<!doctype html><html><head><meta charset="utf-8" /><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><title>github yoink</title><link href="/assets/css/base.css" media="screen" rel="stylesheet" type="text/css" /></head><body class="type images links layout navbar tables desktop-layout desktop-nav"><section><aside class="small" id="nav"><h2><a href="/">Exact<br />Change<br />Only</a></h2><br /><a href="mailto:adamwong246@gmail.com" title="email">adamwong246@gmail.com</a><br /><a class="github" href="https://github.com/adamwong246" title="githubalt"><span class="symbol">circlegithubalt</span></a><a class="stackoverflow" href="http://stackoverflow.com/users/614612/adamwong246" title="stackoverflow"><span class="symbol">circlestackoverflow</span></a><br /><a href="http://www.linkedin.com/profile/view?id=69760011&trk=nav_responsive_tab_profile" title="linkedin"><span class="symbol">circlelinkedin</span></a><a href="https://plus.google.com/104202656400776521456/posts?partnerid=gplp0" title="g_plus"><span class="symbol">circlegoogleplus</span></a><a href="https://twitter.com/adamwong246" title="twitter"><span class="symbol">circletwitter</span></a><a href="https://www.facebook.com/adamwong246" title="facebook"><span class="symbol">circlefacebook</span></a><br /><a href="/about_me.html">about</a><br /><a href="/blog/tags/posts.html">posts</a><br /><a href="/blog/tags/experiments.html">experiments</a><br /><a href="/feed.xml" title="rss"><span class="symbol">circlerss</span></a></aside><div class="large" id="main">  <article>
    <h3>
      <a href="/blog/2014/02/02/github-yoink.html">github yoink</a> <span>Feb  2</span>
    </h3>
    
    <p>I made a neat thing today which I call 'github-yoink' and which generates a block of code from a url to gihub. </p><p>Because my app is so tightly wed to github, I often want to link to my own source code. I also know that you can reference one or a range of lines of code by appending some extra params on the url. You can link to an entire document <a href="full_doc">resume.pdf.slim</a>,  a line in a document <a href="one_line">resume.pdf.slim#L1</a>, or a block of code. <a href="block">resume.pdf.slim#L1#L8</a></p><p>github-yoink takes this a step further- when Middleman compiles the page, the page is Get'ted, parsed and then syntax highlighted. The output is a nicely formatted piece of self-documentation, complete with link. </p><div class="titled-code-block"><h6><a href="https://github.com/adamwong246/adamwong246.github.io/blob/middleman/source/about_me/resumes/resume.pdf.slim">resume.pdf.slim</a></h6><pre class="codehilite plaintext">- kit = PDFKit.new(partial("assets/markdown/resume"),
  :margin_top =&gt; 10,
  :margin_bottom =&gt; 10,
  :margin_left =&gt; 10,
  :margin_right =&gt; 10,
  :disable_smart_shrinking =&gt; false,
  :print_media_type =&gt; true,
  :dpi =&gt; 96)


- kit.stylesheets &lt;&lt; 'source/assets/css/normalize.css'
= kit.to_pdf</pre></div><div class="titled-code-block"><h6><a href="https://github.com/adamwong246/adamwong246.github.io/blob/middleman/source/about_me/resumes/resume.pdf.slim#L1">resume.pdf.slim#L1</a></h6><pre class="codehilite plaintext">- kit = PDFKit.new(partial("assets/markdown/resume"),</pre></div><div class="titled-code-block"><h6><a href="https://github.com/adamwong246/adamwong246.github.io/blob/middleman/source/about_me/resumes/resume.pdf.slim#L1#L8">resume.pdf.slim#L1#L8</a></h6><pre class="codehilite plaintext">- kit = PDFKit.new(partial("assets/markdown/resume"),
  :margin_top =&gt; 10,
  :margin_bottom =&gt; 10,
  :margin_left =&gt; 10,
  :margin_right =&gt; 10,
  :disable_smart_shrinking =&gt; false,
  :print_media_type =&gt; true,
  :dpi =&gt; 96)</pre></div><p>That's sort of meta but *we need to go deeper.* Let's use this technique on itself.</p><div class="titled-code-block"><h6><a href="https://github.com/adamwong246/adamwong246.github.io/blob/middleman/source/partials/gh_yoink.html.slim">gh_yoink.html.slim</a></h6><pre class="codehilite plaintext">ruby:
  matches = link.scan(/#L(\d+){0,2}/).flatten


  doc = Nokogiri::HTML(
    open(
      link.gsub(/#L(\d+){0,2}/, '')
    )
  )


  if matches.length == 0
    output = doc.css(".highlight td.blob-line-code").map(&amp;:content).join("\n")
  elsif matches.length == 1
    output = doc.css(".highlight td.blob-line-code#LC#{matches[0]}").map(&amp;:content).join("\n")
  elsif matches.length == 2
    output = (matches[0]..matches[1]).map{ |m|
      doc.css(".highlight td.blob-line-code#LC#{m.to_i}").map(&amp;:content)
    }.join("\n")
  end


  @display_name = link.split('/').last
  @render_as = link.split('.').last




.titled-code-block  
  h6
    a href=link = @display_name
  - code(@render_as) do
    = output</pre></div><p>How cool is that? Notice how this isn't a helper method, it's a partial!  You call it like this (in slim)...</p><pre class="codehilite ruby"><span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="s1">'partials/gh_yoink'</span><span class="p">,</span> <span class="ss">locals: </span><span class="p">{</span><span class="ss">link: </span><span class="s1">'https://github.com/adamwong246/adamwong246.github.io/blob/middleman/source/about_me/resumes/resume.pdf.slim'</span><span class="p">})</span></pre><p>I've said it before and I'll say it again: Helper methods are for suckers. Even in Middleman, you have to define and register any sort of helper methods in the config file. What a hassle! Meanwhile, partials make great method substitutes.</p>

    
  </article>
</div><hr /><div class="xsmall" id="aside"><p>The thoughts and writing expressed herein are mine alone and do not reflect upon my employer nor any other organization or individual. </p><a href="https://github.com/adamwong246/adamwong246.github.io">source</a><div class="signature"><object><svg viewBox="0 0 640 480" xmlns="http://www.w3.org/2000/svg"><!-- Created with SVG-edit - http://svg-edit.googlecode.com/ --><g><title>Layer 1</title><g id="svg_1"><path stroke="#FFFFFF" fill="none" stroke-width="5" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" id="svg_28" d="m31.497704,329.275909c1.397758,0 5.713264,-1.109741 12.579849,-4.193268c8.553589,-3.841125 20.910904,-9.939575 55.910461,-22.364166c27.911491,-9.908386 70.982491,-22.026184 123.002998,-36.341827c104.267654,-28.693573 184.504471,-50.319382 271.165665,-72.683578l82.467896,-16.773132"></path><path stroke="#FFFFFF" fill="none" stroke-width="5" stroke-dasharray="null" stroke-linejoin="null" stroke-linecap="null" id="svg_26" d="m30.099941,448.085632c0,1.397766 -2.039057,1.826233 -2.795521,0c-1.069811,-2.582703 1.232979,-11.221802 8.386566,-40.535065c4.098991,-16.796448 14.479336,-59.005249 30.750748,-106.229858c19.878845,-57.694504 42.760948,-113.476639 53.114929,-135.582855c10.605553,-22.64328 17.516258,-35.666718 25.159706,-41.932846c3.897415,-3.195099 8.407516,-5.249481 11.182083,-5.591049c5.71994,-0.70414 9.784332,-1.397758 11.182098,-1.397758c2.795517,0 4.310669,1.342094 5.591049,4.193291c3.083542,6.866592 8.020737,39.200333 13.9776,72.683578c9.219254,51.820892 21.512238,95.363663 40.53508,145.367172c8.029282,21.105835 13.977615,40.535095 18.170898,48.921661c1.397766,2.795532 2.635117,-0.066315 5.591049,-6.988831c6.632416,-15.53241 17.016357,-37.637604 32.148499,-74.081329c15.627228,-37.635986 22.672363,-64.303024 47.523895,-82.467911c6.076904,-4.441833 -5.819092,32.365311 1.397766,111.820908c2.72934,30.049835 17.116272,38.395233 30.750732,29.352997c22.254883,-14.759308 89.456757,-132.787338 190.095551,-272.563477l39.137329,-51.717167l0,-4.193287"></path></g></g></svg></object></div></div></section></body></html>